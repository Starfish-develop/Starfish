#based off of github.com/bd-j/speccal

all: paper.pdf

#Inserts a version control tag at the bottom of the PDF document
vc.tex: ../.git/logs/HEAD
	echo "%%% This file is generated by Makefile." > vc.tex
	git log -1 --date=short --format="format:\\newcommand{\\githash}{%h}\\newcommand{\\gitdate}{%ad}\\newcommand{\\gitauthor}{%an}" >> vc.tex

# '$<' holds the first dependency of a rule
# 'latexmk' properly handles latex files, bib files, and should be included with all
# latex distributions
# -use-make tells latexmk to call 'make' to generate missing files
%.pdf: %.tex vc.tex
	latexmk -pdf $<

clean:
	latexmk -c
	rm *.bbl *.blg *.dvi *.fdb_latexmk *Notes.bib
